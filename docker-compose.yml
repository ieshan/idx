services:
  exec-test:
    image: golang:1.24.5-bookworm
    volumes:
      - "./:/app"
    networks:
      - idx-network
    working_dir: "/app"
    depends_on:
      - mongo
      - postgres
      - mariadb
    command: "go mod download && go test -tags=integration -v"
  postgres:
    image: postgres:17.5-alpine3.22
    restart: always
    environment:
      POSTGRES_PASSWORD: password
    networks:
      - idx-network
  mariadb:
    image: mariadb:11.8.2-ubi9
    restart: always
    environment:
      MARIADB_ROOT_PASSWORD: password
    networks:
      - idx-network
  mongo:
    image: mongo:8.0.11-noble
    restart: always
    environment:
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: password
    networks:
      - idx-network
networks:
  idx-network:
    driver: bridge

